(this["webpackJsonpnc-news"]=this["webpackJsonpnc-news"]||[]).push([[0],{24:function(e,t,a){e.exports=a(52)},52:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),o=a.n(c),s=a(1),l=a(2),i=a(4),m=a(3),u=(a(7),function(e){return r.a.createElement("header",{className:"container"},r.a.createElement("h1",null,"Northcoders News"),r.a.createElement("p",null,"Welcome ",e.username))}),p=a(20),d=a.n(p).a.create({baseURL:"http://salex-nc-news-server.herokuapp.com/api"}),h=function(){return d.get("/topics").then((function(e){return e.data.topics}))},f=function(e){var t=e.topic,a=e.sort_by,n=e.order;return d.get("/articles",{params:{topic:t,sort_by:a,order:n}}).then((function(e){return e.data.articles}))},E=function(e){var t=e.article_id;return d.get("/articles/".concat(t)).then((function(e){return e.data.article}))},v=function(e){var t=e.article_id;return d.get("/articles/".concat(t,"/comments")).then((function(e){return e.data.comments}))},b=function(e,t,a){return d.patch("/".concat(a,"/").concat(t),{inc_votes:e}).then((function(e){return e.data}))},g=function(e,t){return d.post("/articles/".concat(t,"/comments"),e).then((function(e){return e.data.comment}))},y=function(e){return d.delete("/comments/".concat(e))},C=function(){return r.a.createElement("div",{id:"loader"})},O=a(6),_=function(e){var t=e.status,a=e.msg;return r.a.createElement("div",{className:"mainBody"},r.a.createElement("h3",null,"OOOPS, SOMETHING WENT WRONG!"),r.a.createElement("p",null,"Status: ",t||500),r.a.createElement("p",null,"Message: ",a||"Try again later"))},j=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={topics:[],isLoading:!0,topicError:null},e.componentDidMount=function(){e.fetchTopics()},e.fetchTopics=function(){h().then((function(t){e.setState({topics:t,isLoading:!1})})).catch((function(t){e.setState({topicError:{status:t.response.status,msg:t.response.data.message}})}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.topics,a=e.isLoading,n=e.topicError;return n?r.a.createElement(_,{status:n.status,msg:n.msg}):a?r.a.createElement(C,null):r.a.createElement("nav",{className:"container"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(O.a,{to:"/",className:"nava"},"all articles")),t.map((function(e){return r.a.createElement("li",{key:e.slug},r.a.createElement(O.a,{to:"/articles/topics/".concat(e.slug),className:"nava"},e.slug))}))))}}]),a}(n.Component),S=function(e){var t=e.article;return r.a.createElement("article",{className:"articleCard"},r.a.createElement("h3",null,r.a.createElement(O.a,{to:"/articles/".concat(t.article_id),className:"articleLink"},t.title)),r.a.createElement("p",null,"votes: ",t.votes),r.a.createElement("p",null,"written by: ",t.author),r.a.createElement("p",null,"comments: ",t.comment_count))},N=function(e){var t=e.sort_by,a=e.order,n=e.handleChangeOrder,c=e.handleChangeSortBy;return r.a.createElement("form",{className:"sortByForm"},r.a.createElement("label",null,"Sort articles by:",r.a.createElement("select",{sort_by:t,onChange:c},r.a.createElement("option",{sort_by:"created_at"},"created_at"),r.a.createElement("option",{sort_by:"votes"},"votes"),r.a.createElement("option",{sort_by:"comment_count"},"comment_count"))),r.a.createElement("label",null,"Arrange by:",r.a.createElement("select",{order:a,onChange:n},r.a.createElement("option",{order:"desc"},"desc"),r.a.createElement("option",{order:"asc"},"asc"))))},k=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={articles:[],isLoading:!0,sort_by:"",order:"desc",topicError:null},e.componentDidMount=function(){e.fetchArticles()},e.componentDidUpdate=function(t,a){t.topic===e.props.topic&&a.sort_by===e.state.sort_by&&a.order===e.state.order||e.fetchArticles()},e.handleChangeSortBy=function(t){e.setState({sort_by:t.target.value})},e.handleChangeOrder=function(t){e.setState({order:t.target.value})},e.fetchArticles=function(){var t=e.props.topic,a=e.state,n=a.sort_by,r=a.order;f({topic:t,sort_by:n,order:r}).then((function(t){e.setState({articles:t,isLoading:!1})})).catch((function(t){console.dir(t),e.setState({topicError:{status:t.response.status,msg:t.response.data.message},isLoading:!1})}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.articles,a=e.isLoading,n=e.sort_by,c=e.order,o=e.topicError;return a?r.a.createElement(C,null):o?r.a.createElement(_,{status:o.status,msg:o.msg}):r.a.createElement("main",{className:"mainBody"},r.a.createElement(N,{sort_by:n,order:c,handleChangeOrder:this.handleChangeOrder,handleChangeSortBy:this.handleChangeSortBy}),t.map((function(e){return r.a.createElement(S,{article:e,key:e.article_id})})))}}]),a}(n.Component),w=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={optimisticVotes:0},e.handleClick=function(t){e.setState((function(e){return{optimisticVotes:e.optimisticVotes+t}})),b(t,e.props.id,e.props.type)},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.optimisticVotes;return r.a.createElement("div",null,r.a.createElement("p",null,"Votes: ",this.props.votes+t),r.a.createElement("button",{className:"btn btn-3",onClick:function(){e.handleClick(1)},disabled:t>0},"I love it!"),r.a.createElement("button",{className:"btn btn-2",onClick:function(){e.handleClick(-1)},disabled:t<0},"Not for me."))}}]),a}(n.Component),A=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={article:{},isLoading:!0,articleError:null},e.componentDidMount=function(){e.fetchSingleArticle()},e.fetchSingleArticle=function(){var t=e.props.article_id;E({article_id:t}).then((function(t){e.setState({article:t,isLoading:!1})})).catch((function(t){console.dir(t),e.setState({articleError:{status:t.response.status,msg:t.response.data.message},isLoading:!1})}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.article,a=e.isLoading,n=e.articleError;return a?r.a.createElement(C,null):n?r.a.createElement(_,{status:n.status,msg:n.msg}):r.a.createElement("main",{className:"mainBody"},r.a.createElement("div",{className:"fullArticle"},r.a.createElement("h3",null,t.title),r.a.createElement("p",{className:"p1"},"written by: ",t.author),r.a.createElement("p",{className:"p2"},t.body),r.a.createElement("div",{className:"votesBox"},r.a.createElement(w,{votes:t.votes,id:t.article_id,type:"articles"})),r.a.createElement("h4",null,r.a.createElement(O.a,{to:"/articles/".concat(t.article_id,"/comments")},"See comments"))))}}]),a}(n.Component),L=a(23),I=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){e.props.author===e.props.username?(y(t),e.props.removeComment(t)):alert("You are not authorised to delete this comment")},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.comment_id,n=t.author;return r.a.createElement("div",{id:"delete"},r.a.createElement("button",{onClick:function(){e.handleClick(a,n)}},"Delete comment"))}}]),a}(n.Component),B=function(e){var t=e.comment,a=e.username,n=e.removeComment;return r.a.createElement("article",{className:"comments"},r.a.createElement("li",null,r.a.createElement("p",null,t.body),r.a.createElement("p",{className:"p1"},t.author),r.a.createElement(I,{comment_id:t.comment_id,author:t.author,username:a,removeComment:n,className:"delete"}),r.a.createElement("div",{className:"commentVotes"},r.a.createElement(w,{votes:t.votes,id:t.comment_id,type:"comments"}))))},D=a(22),x=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={commentInput:"",postError:null},e.handleChange=function(t){var a=t.target,n=a.value,r=a.name;e.setState(Object(D.a)({},r,n))},e.handleSubmit=function(t){t.preventDefault();var a=e.props,n=a.article_id,r=a.addComment,c=e.state.commentInput,o={username:e.props.username,body:c};g(o,n).then((function(e){r(e)})).catch((function(t){e.setState({postError:{status:t.response.status,msg:t.response.data.message}})})),e.setState({commentInput:""})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.commentInput,a=e.postError,n=this.props.username;return a?r.a.createElement(_,{status:a.status,msg:a.msg}):r.a.createElement("form",{onSubmit:this.handleSubmit,id:"commentForm"},r.a.createElement("label",{className:"username"},"Username:",r.a.createElement("input",{type:"text",name:"usernameInput",value:n,onChange:this.handleChange})),r.a.createElement("label",{className:"comment"},r.a.createElement("textarea",{type:"text",placeholder:"have your say..",name:"commentInput",value:t,onChange:this.handleChange})),r.a.createElement("button",null,"Submit"))}}]),a}(n.Component),M=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={comments:[],isLoading:!0,commentError:null},e.componentDidMount=function(){e.fetchComments()},e.fetchComments=function(){var t=e.props.article_id;v({article_id:t}).then((function(t){e.setState({comments:t,isLoading:!1})})).catch((function(t){e.setState({commentError:{status:t.response.status,msg:t.response.data.message}})}))},e.addComment=function(t){e.setState((function(e){var a=e.comments;return{comments:[].concat(Object(L.a)(a),[t])}}))},e.removeComment=function(t){e.setState((function(e){return{comments:e.comments.filter((function(e){return e.comment_id!==t}))}}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.comments,n=t.isLoading,c=t.commentError,o=this.props.article_id;return c?r.a.createElement(_,{status:c.status,msg:c.msg}):n?r.a.createElement(C,null):r.a.createElement("div",{className:"commentCard"},r.a.createElement("ul",null,a.map((function(t){return r.a.createElement(B,{comment:t,username:e.props.username,key:t.comment_id,removeComment:e.removeComment})})),r.a.createElement(x,{article_id:o,addComment:this.addComment,username:this.props.username})))}}]),a}(n.Component),V=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userInfo:{username:"jessjelly"}},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(u,{username:this.state.userInfo.username}),r.a.createElement(j,null),r.a.createElement(O.b,null,r.a.createElement(k,{path:"/"}),r.a.createElement(k,{path:"/articles/topics/:topic"}),r.a.createElement(A,{path:"/articles/:article_id"}),r.a.createElement(M,{path:"/articles/:article_id/comments",username:this.state.userInfo.username}),r.a.createElement(_,{default:!0,status:404,msg:"page not found"})))}}]),a}(n.Component);o.a.render(r.a.createElement(V,null),document.getElementById("root"))},7:function(e,t,a){}},[[24,1,2]]]);
//# sourceMappingURL=main.6b52942e.chunk.js.map